Below are the **full CKS-style answers** for:

âœ… **Question 14 â€” Find which pod writes to /dev/mem with privileged=true (mention Falco)**
âœ… **Question 15 â€” Scan multi-container pod, find vulnerable Alpine image, generate BOM â†’ spdx.json**

These answers are in the exact *exam-ready* step-by-step formula.

---

# ðŸŸ¦ **QUESTION 14 â€” Identify which Deployment/Pod writes to `/dev/mem` (privileged=true)**

### **Task Description**

You have *three Deployments* of Ollama.
You must determine **which pod writes to `/dev/mem`**.
All have:

```
SecurityContext: privileged=true
```

You must identify the offending pod and mention **Falco** as the recommended tool.

---

# âœ… **Step 1 â€” Check security context of the 3 Deployments**

(Quick visual verification)

```bash
kubectl get deploy -n <ns>
kubectl describe deploy <name> -n <ns> | grep -i privileged -A3
```

This tells you which Deployments have:

```yaml
securityContext:
  privileged: true
```

But this **does NOT tell you which one writes to /dev/mem**.

---

# âœ… **Step 2 â€” Use Falco to detect writes to `/dev/mem`**

Falco has an official rule detecting this behavior:

---

## ðŸ“˜ **Falco Documentation Reference (important for CKS)**

Falco rule: **â€œWrite below /devâ€** or **"Write to special files like /dev/mem"**

Rule file locations:

* `/etc/falco/falco_rules.yaml`
* `/etc/falco/rules.d/`

Rule example:

```yaml
- rule: Write to dev mem
  desc: Detect any write attempt to /dev/mem
  condition: evt.type=write and fd.name=/dev/mem
  output: "Write to /dev/mem detected (user=%user.name pod=%k8s.pod.name container=%container.name)"
  priority: CRITICAL
```

---

# âœ… **Step 3 â€” Run Falco and identify the pod**

Start Falco:

```bash
sudo falco -o json_output=true
```

(or use the DaemonSet if already installed)

Watch output:

```bash
sudo journalctl -u falco -f
```

Expected alert:

```
Write to /dev/mem detected (pod=ollama-deploy-2-xxx container=ollama)
```

This gives you:

* Pod name
* Deployment name
* Container name

---

# âœ… **Step 4 â€” Answer (CKS-style)**

**The pod that wrote to `/dev/mem` is the one Falco reported in the alert stream.**

Falco is the **correct Kubernetes runtime security tool** to detect writes to kernel memory devices such as `/dev/mem`.

---

# ðŸŸ© Question 14 DONE.

---

# ðŸŸ¦ **QUESTION 15 â€” Scan Pod with 3 Alpine Containers â†’ Find which version includes `libproc_ar 1.3-45` â†’ Output SPDX**

### **Task Description**

You have a Pod with **3 containers**:

```
alpine:3.14
alpine:3.16
alpine:3.18
```

You need to:

1. Scan all three images
2. Find which image contains **libproc_ar version 1.3-45**
3. Generate a BOM
4. Redirect the output to `spdx.json`

You must use: **bom** (Syft-style tool)

---

# ðŸš€ Tool Used in CKS: **Syft (bom)**

Credit: Anchore (open-source) â€” used for SBOM generation.

Installed name varies, either:

```
syft
```

or:

```
bom
```

Exam commonly uses:

```
bom
```

---

# âœ… **Step 1 â€” Pull all Alpine images**

If not already pulled:

```bash
docker pull alpine:3.14
docker pull alpine:3.16
docker pull alpine:3.18
```

---

# âœ… **Step 2 â€” Scan each image for the library**

Run:

```bash
bom alpine:3.14 | grep -i libproc_ar
bom alpine:3.16 | grep -i libproc_ar
bom alpine:3.18 | grep -i libproc_ar
```

You search for version **1.3-45**.

Example of expected match:

```
libproc_ar 1.3-45  apk
```

---

# ðŸŸ© **Result:**

The image that shows:

```
libproc_ar 1.3-45
```

is the one required by the question.

(Usually Alpine 3.14 or 3.16 contains this version, depending on exam version.)

---

# âœ… **Step 3 â€” Generate SPDX SBOM for that image**

Example: if the vulnerable image is `alpine:3.16`

```bash
bom alpine:3.16 -o spdx-json > spdx.json
```

Or using syft syntax:

```bash
syft alpine:3.16 -o spdx-json > spdx.json
```

---

# ðŸŽ¯ **CKS exam expects the EXACT output redirection line:**

```
> spdx.json
```

---

# ðŸŸ© Question 15 DONE.

---

If you want, I can prepare:

âœ… A single **complete CKS exam sheet** summarizing Questions 1â€“15
OR
âœ… A simulated CKS practice exam where you solve similar problems in real time.

Just tell me!
